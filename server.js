var express = require('express');
var bodyParser = require('body-parser');
var app = express();



const ftm_rpc = "https://rpcapi.fantom.network"

const { ethers } = require("ethers");

const Web3 = require('web3');
const web3 = new Web3(new Web3.providers.HttpProvider(ftm_rpc));
const abi = JSON.parse('[{"constant":false,"inputs":[{"name":"candidate","type":"bytes32"}],"name":"totalVotesFor","outputs":[{"name":"","type":"uint8"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"candidate","type":"bytes32"}],"name":"validCandidate","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"bytes32"}],"name":"votesReceived","outputs":[{"name":"","type":"uint8"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"x","type":"bytes32"}],"name":"bytes32ToString","outputs":[{"name":"","type":"string"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"candidateList","outputs":[{"name":"","type":"bytes32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"candidate","type":"bytes32"}],"name":"voteForCandidate","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"contractOwner","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"inputs":[{"name":"candidateNames","type":"bytes32[]"}],"payable":false,"type":"constructor"}]')


const abiRarity = [{ "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "owner", "type": "address" }, { "indexed": true, "internalType": "address", "name": "approved", "type": "address" }, { "indexed": true, "internalType": "uint256", "name": "tokenId", "type": "uint256" }], "name": "Approval", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "owner", "type": "address" }, { "indexed": true, "internalType": "address", "name": "operator", "type": "address" }, { "indexed": false, "internalType": "bool", "name": "approved", "type": "bool" }], "name": "ApprovalForAll", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "from", "type": "address" }, { "indexed": true, "internalType": "address", "name": "to", "type": "address" }, { "indexed": true, "internalType": "uint256", "name": "tokenId", "type": "uint256" }], "name": "Transfer", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "owner", "type": "address" }, { "indexed": false, "internalType": "uint256", "name": "level", "type": "uint256" }, { "indexed": false, "internalType": "uint256", "name": "summoner", "type": "uint256" }], "name": "leveled", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "owner", "type": "address" }, { "indexed": false, "internalType": "uint256", "name": "class", "type": "uint256" }, { "indexed": false, "internalType": "uint256", "name": "summoner", "type": "uint256" }], "name": "summoned", "type": "event" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }], "name": "adventure", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "name": "adventurers_log", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "to", "type": "address" }, { "internalType": "uint256", "name": "tokenId", "type": "uint256" }], "name": "approve", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "owner", "type": "address" }], "name": "balanceOf", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "name": "class", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "id", "type": "uint256" }], "name": "classes", "outputs": [{ "internalType": "string", "name": "description", "type": "string" }], "stateMutability": "pure", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "tokenId", "type": "uint256" }], "name": "getApproved", "outputs": [{ "internalType": "address", "name": "", "type": "address" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "owner", "type": "address" }, { "internalType": "address", "name": "operator", "type": "address" }], "name": "isApprovedForAll", "outputs": [{ "internalType": "bool", "name": "", "type": "bool" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "name": "level", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }], "name": "level_up", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [], "name": "name", "outputs": [{ "internalType": "string", "name": "", "type": "string" }], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "next_summoner", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "tokenId", "type": "uint256" }], "name": "ownerOf", "outputs": [{ "internalType": "address", "name": "", "type": "address" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "from", "type": "address" }, { "internalType": "address", "name": "to", "type": "address" }, { "internalType": "uint256", "name": "tokenId", "type": "uint256" }], "name": "safeTransferFrom", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "from", "type": "address" }, { "internalType": "address", "name": "to", "type": "address" }, { "internalType": "uint256", "name": "tokenId", "type": "uint256" }, { "internalType": "bytes", "name": "_data", "type": "bytes" }], "name": "safeTransferFrom", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "operator", "type": "address" }, { "internalType": "bool", "name": "approved", "type": "bool" }], "name": "setApprovalForAll", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }, { "internalType": "uint256", "name": "_xp", "type": "uint256" }], "name": "spend_xp", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_class", "type": "uint256" }], "name": "summon", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }], "name": "summoner", "outputs": [{ "internalType": "uint256", "name": "_xp", "type": "uint256" }, { "internalType": "uint256", "name": "_log", "type": "uint256" }, { "internalType": "uint256", "name": "_class", "type": "uint256" }, { "internalType": "uint256", "name": "_level", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "symbol", "outputs": [{ "internalType": "string", "name": "", "type": "string" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }], "name": "tokenURI", "outputs": [{ "internalType": "string", "name": "", "type": "string" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "from", "type": "address" }, { "internalType": "address", "name": "to", "type": "address" }, { "internalType": "uint256", "name": "tokenId", "type": "uint256" }], "name": "transferFrom", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "name": "xp", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "curent_level", "type": "uint256" }], "name": "xp_required", "outputs": [{ "internalType": "uint256", "name": "xp_to_next_level", "type": "uint256" }], "stateMutability": "pure", "type": "function" }]
const abiRarityAttr = [{ "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "creator", "type": "address" }, { "indexed": false, "internalType": "uint256", "name": "summoner", "type": "uint256" }, { "indexed": false, "internalType": "uint32", "name": "strength", "type": "uint32" }, { "indexed": false, "internalType": "uint32", "name": "dexterity", "type": "uint32" }, { "indexed": false, "internalType": "uint32", "name": "constitution", "type": "uint32" }, { "indexed": false, "internalType": "uint32", "name": "intelligence", "type": "uint32" }, { "indexed": false, "internalType": "uint32", "name": "wisdom", "type": "uint32" }, { "indexed": false, "internalType": "uint32", "name": "charisma", "type": "uint32" }], "name": "Created", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "address", "name": "leveler", "type": "address" }, { "indexed": false, "internalType": "uint256", "name": "summoner", "type": "uint256" }, { "indexed": false, "internalType": "uint32", "name": "strength", "type": "uint32" }, { "indexed": false, "internalType": "uint32", "name": "dexterity", "type": "uint32" }, { "indexed": false, "internalType": "uint32", "name": "constitution", "type": "uint32" }, { "indexed": false, "internalType": "uint32", "name": "intelligence", "type": "uint32" }, { "indexed": false, "internalType": "uint32", "name": "wisdom", "type": "uint32" }, { "indexed": false, "internalType": "uint32", "name": "charisma", "type": "uint32" }], "name": "Leveled", "type": "event" }, { "inputs": [{ "internalType": "uint256", "name": "current_level", "type": "uint256" }], "name": "abilities_by_level", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "pure", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "name": "ability_scores", "outputs": [{ "internalType": "uint32", "name": "strength", "type": "uint32" }, { "internalType": "uint32", "name": "dexterity", "type": "uint32" }, { "internalType": "uint32", "name": "constitution", "type": "uint32" }, { "internalType": "uint32", "name": "intelligence", "type": "uint32" }, { "internalType": "uint32", "name": "wisdom", "type": "uint32" }, { "internalType": "uint32", "name": "charisma", "type": "uint32" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "score", "type": "uint256" }], "name": "calc", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "pure", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_str", "type": "uint256" }, { "internalType": "uint256", "name": "_dex", "type": "uint256" }, { "internalType": "uint256", "name": "_const", "type": "uint256" }, { "internalType": "uint256", "name": "_int", "type": "uint256" }, { "internalType": "uint256", "name": "_wis", "type": "uint256" }, { "internalType": "uint256", "name": "_cha", "type": "uint256" }], "name": "calculate_point_buy", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "pure", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "name": "character_created", "outputs": [{ "internalType": "bool", "name": "", "type": "bool" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }], "name": "increase_charisma", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }], "name": "increase_constitution", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }], "name": "increase_dexterity", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }], "name": "increase_intelligence", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }], "name": "increase_strength", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }], "name": "increase_wisdom", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "name": "level_points_spent", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }, { "internalType": "uint32", "name": "_str", "type": "uint32" }, { "internalType": "uint32", "name": "_dex", "type": "uint32" }, { "internalType": "uint32", "name": "_const", "type": "uint32" }, { "internalType": "uint32", "name": "_int", "type": "uint32" }, { "internalType": "uint32", "name": "_wis", "type": "uint32" }, { "internalType": "uint32", "name": "_cha", "type": "uint32" }], "name": "point_buy", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }], "name": "tokenURI", "outputs": [{ "internalType": "string", "name": "", "type": "string" }], "stateMutability": "view", "type": "function" }]
const abiRarityGold = [{ "anonymous": false, "inputs": [{ "indexed": true, "internalType": "uint256", "name": "from", "type": "uint256" }, { "indexed": true, "internalType": "uint256", "name": "to", "type": "uint256" }, { "indexed": false, "internalType": "uint256", "name": "amount", "type": "uint256" }], "name": "Approval", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "internalType": "uint256", "name": "from", "type": "uint256" }, { "indexed": true, "internalType": "uint256", "name": "to", "type": "uint256" }, { "indexed": false, "internalType": "uint256", "name": "amount", "type": "uint256" }], "name": "Transfer", "type": "event" }, { "inputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }, { "internalType": "uint256", "name": "", "type": "uint256" }], "name": "allowance", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "from", "type": "uint256" }, { "internalType": "uint256", "name": "spender", "type": "uint256" }, { "internalType": "uint256", "name": "amount", "type": "uint256" }], "name": "approve", "outputs": [{ "internalType": "bool", "name": "", "type": "bool" }], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "name": "balanceOf", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "summoner", "type": "uint256" }], "name": "claim", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "summoner", "type": "uint256" }], "name": "claimable", "outputs": [{ "internalType": "uint256", "name": "amount", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "name": "claimed", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "decimals", "outputs": [{ "internalType": "uint8", "name": "", "type": "uint8" }], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "name", "outputs": [{ "internalType": "string", "name": "", "type": "string" }], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "symbol", "outputs": [{ "internalType": "string", "name": "", "type": "string" }], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "totalSupply", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "from", "type": "uint256" }, { "internalType": "uint256", "name": "to", "type": "uint256" }, { "internalType": "uint256", "name": "amount", "type": "uint256" }], "name": "transfer", "outputs": [{ "internalType": "bool", "name": "", "type": "bool" }], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "executor", "type": "uint256" }, { "internalType": "uint256", "name": "from", "type": "uint256" }, { "internalType": "uint256", "name": "to", "type": "uint256" }, { "internalType": "uint256", "name": "amount", "type": "uint256" }], "name": "transferFrom", "outputs": [{ "internalType": "bool", "name": "", "type": "bool" }], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "level", "type": "uint256" }], "name": "wealth_by_level", "outputs": [{ "internalType": "uint256", "name": "wealth", "type": "uint256" }], "stateMutability": "pure", "type": "function" }]
const abiRarityAbilities = [{ "inputs": [{ "internalType": "uint256", "name": "_class", "type": "uint256" }], "name": "base_per_class", "outputs": [{ "internalType": "uint256", "name": "base", "type": "uint256" }], "stateMutability": "pure", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_class", "type": "uint256" }, { "internalType": "uint8[36]", "name": "_skills", "type": "uint8[36]" }], "name": "calculate_points_for_set", "outputs": [{ "internalType": "uint256", "name": "points", "type": "uint256" }], "stateMutability": "pure", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_class", "type": "uint256" }], "name": "class_skills", "outputs": [{ "internalType": "bool[36]", "name": "_skills", "type": "bool[36]" }], "stateMutability": "pure", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_class", "type": "uint256" }], "name": "class_skills_by_name", "outputs": [{ "internalType": "string[]", "name": "", "type": "string[]" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }], "name": "get_skills", "outputs": [{ "internalType": "uint8[36]", "name": "", "type": "uint8[36]" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }, { "internalType": "uint8[36]", "name": "_skills", "type": "uint8[36]" }], "name": "is_valid_set", "outputs": [{ "internalType": "bool", "name": "", "type": "bool" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_attribute", "type": "uint256" }], "name": "modifier_for_attribute", "outputs": [{ "internalType": "int256", "name": "_modifier", "type": "int256" }], "stateMutability": "pure", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_summoner", "type": "uint256" }, { "internalType": "uint8[36]", "name": "_skills", "type": "uint8[36]" }], "name": "set_skills", "outputs": [], "stateMutability": "nonpayable", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }, { "internalType": "uint256", "name": "", "type": "uint256" }], "name": "skills", "outputs": [{ "internalType": "uint8", "name": "", "type": "uint8" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "int256", "name": "_int", "type": "int256" }, { "internalType": "uint256", "name": "_class", "type": "uint256" }, { "internalType": "uint256", "name": "_level", "type": "uint256" }], "name": "skills_per_level", "outputs": [{ "internalType": "uint256", "name": "points", "type": "uint256" }], "stateMutability": "pure", "type": "function" }]
const abiRarityLibrary = [{ "inputs": [], "name": "_attr", "outputs": [{ "internalType": "contract rarity_attributes", "name": "", "type": "address" }], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "_gold", "outputs": [{ "internalType": "contract rarity_gold", "name": "", "type": "address" }], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "_items1", "outputs": [{ "internalType": "contract rarity_item1", "name": "", "type": "address" }], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "_mat1", "outputs": [{ "internalType": "contract rarity_mat1", "name": "", "type": "address" }], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "_names", "outputs": [{ "internalType": "contract rarity_names", "name": "", "type": "address" }], "stateMutability": "view", "type": "function" }, { "inputs": [], "name": "_skills", "outputs": [{ "internalType": "contract rarity_skills", "name": "", "type": "address" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_s", "type": "uint256" }], "name": "ability_modifiers", "outputs": [{ "components": [{ "internalType": "int32", "name": "_str", "type": "int32" }, { "internalType": "int32", "name": "_dex", "type": "int32" }, { "internalType": "int32", "name": "_con", "type": "int32" }, { "internalType": "int32", "name": "_int", "type": "int32" }, { "internalType": "int32", "name": "_wis", "type": "int32" }, { "internalType": "int32", "name": "_cha", "type": "int32" }], "internalType": "struct rl._ability_modifiers", "name": "modifiers", "type": "tuple" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_s", "type": "uint256" }], "name": "ability_scores", "outputs": [{ "components": [{ "internalType": "uint32", "name": "_str", "type": "uint32" }, { "internalType": "uint32", "name": "_dex", "type": "uint32" }, { "internalType": "uint32", "name": "_con", "type": "uint32" }, { "internalType": "uint32", "name": "_int", "type": "uint32" }, { "internalType": "uint32", "name": "_wis", "type": "uint32" }, { "internalType": "uint32", "name": "_cha", "type": "uint32" }], "internalType": "struct rl._ability_scores", "name": "scores", "type": "tuple" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_s", "type": "uint256" }], "name": "ability_scores_full", "outputs": [{ "components": [{ "components": [{ "internalType": "uint32", "name": "_str", "type": "uint32" }, { "internalType": "uint32", "name": "_dex", "type": "uint32" }, { "internalType": "uint32", "name": "_con", "type": "uint32" }, { "internalType": "uint32", "name": "_int", "type": "uint32" }, { "internalType": "uint32", "name": "_wis", "type": "uint32" }, { "internalType": "uint32", "name": "_cha", "type": "uint32" }], "internalType": "struct rl._ability_scores", "name": "attributes", "type": "tuple" }, { "components": [{ "internalType": "int32", "name": "_str", "type": "int32" }, { "internalType": "int32", "name": "_dex", "type": "int32" }, { "internalType": "int32", "name": "_con", "type": "int32" }, { "internalType": "int32", "name": "_int", "type": "int32" }, { "internalType": "int32", "name": "_wis", "type": "int32" }, { "internalType": "int32", "name": "_cha", "type": "int32" }], "internalType": "struct rl._ability_modifiers", "name": "modifiers", "type": "tuple" }, { "internalType": "uint256", "name": "total_points", "type": "uint256" }, { "internalType": "uint256", "name": "spent_points", "type": "uint256" }, { "internalType": "bool", "name": "created", "type": "bool" }], "internalType": "struct rl._ability_scores_full", "name": "scores_full", "type": "tuple" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_s", "type": "uint256" }], "name": "base", "outputs": [{ "components": [{ "internalType": "string", "name": "name", "type": "string" }, { "internalType": "uint256", "name": "xp", "type": "uint256" }, { "internalType": "uint256", "name": "log", "type": "uint256" }, { "internalType": "uint256", "name": "class", "type": "uint256" }, { "internalType": "uint256", "name": "level", "type": "uint256" }], "internalType": "struct rl._base", "name": "c", "type": "tuple" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_s", "type": "uint256" }], "name": "description", "outputs": [{ "internalType": "string", "name": "full_name", "type": "string" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_s", "type": "uint256" }], "name": "gold", "outputs": [{ "components": [{ "internalType": "uint256", "name": "balance", "type": "uint256" }, { "internalType": "uint256", "name": "claimed", "type": "uint256" }, { "internalType": "uint256", "name": "claimable", "type": "uint256" }], "internalType": "struct rl._gold", "name": "g", "type": "tuple" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "address", "name": "_owner", "type": "address" }], "name": "items1", "outputs": [{ "components": [{ "internalType": "uint8", "name": "base_type", "type": "uint8" }, { "internalType": "uint8", "name": "item_type", "type": "uint8" }, { "internalType": "uint32", "name": "crafted", "type": "uint32" }, { "internalType": "uint256", "name": "crafter", "type": "uint256" }], "internalType": "struct rl._item1[]", "name": "items", "type": "tuple[]" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_s", "type": "uint256" }], "name": "materials", "outputs": [{ "components": [{ "internalType": "uint256", "name": "balance", "type": "uint256" }, { "internalType": "uint256", "name": "scout", "type": "uint256" }], "internalType": "struct rl._material[]", "name": "mats", "type": "tuple[]" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_s", "type": "uint256" }], "name": "name", "outputs": [{ "internalType": "string", "name": "summoner_name", "type": "string" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_s", "type": "uint256" }], "name": "skills", "outputs": [{ "components": [{ "internalType": "uint8[36]", "name": "skills", "type": "uint8[36]" }, { "internalType": "bool[36]", "name": "class_skills", "type": "bool[36]" }, { "internalType": "uint256", "name": "total_points", "type": "uint256" }, { "internalType": "uint256", "name": "spent_points", "type": "uint256" }], "internalType": "struct rl._skills", "name": "s", "type": "tuple" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "_s", "type": "uint256" }], "name": "summoner_full", "outputs": [{ "components": [{ "components": [{ "internalType": "string", "name": "name", "type": "string" }, { "internalType": "uint256", "name": "xp", "type": "uint256" }, { "internalType": "uint256", "name": "log", "type": "uint256" }, { "internalType": "uint256", "name": "class", "type": "uint256" }, { "internalType": "uint256", "name": "level", "type": "uint256" }], "internalType": "struct rl._base", "name": "base", "type": "tuple" }, { "components": [{ "components": [{ "internalType": "uint32", "name": "_str", "type": "uint32" }, { "internalType": "uint32", "name": "_dex", "type": "uint32" }, { "internalType": "uint32", "name": "_con", "type": "uint32" }, { "internalType": "uint32", "name": "_int", "type": "uint32" }, { "internalType": "uint32", "name": "_wis", "type": "uint32" }, { "internalType": "uint32", "name": "_cha", "type": "uint32" }], "internalType": "struct rl._ability_scores", "name": "attributes", "type": "tuple" }, { "components": [{ "internalType": "int32", "name": "_str", "type": "int32" }, { "internalType": "int32", "name": "_dex", "type": "int32" }, { "internalType": "int32", "name": "_con", "type": "int32" }, { "internalType": "int32", "name": "_int", "type": "int32" }, { "internalType": "int32", "name": "_wis", "type": "int32" }, { "internalType": "int32", "name": "_cha", "type": "int32" }], "internalType": "struct rl._ability_modifiers", "name": "modifiers", "type": "tuple" }, { "internalType": "uint256", "name": "total_points", "type": "uint256" }, { "internalType": "uint256", "name": "spent_points", "type": "uint256" }, { "internalType": "bool", "name": "created", "type": "bool" }], "internalType": "struct rl._ability_scores_full", "name": "ability_scores", "type": "tuple" }, { "components": [{ "internalType": "uint8[36]", "name": "skills", "type": "uint8[36]" }, { "internalType": "bool[36]", "name": "class_skills", "type": "bool[36]" }, { "internalType": "uint256", "name": "total_points", "type": "uint256" }, { "internalType": "uint256", "name": "spent_points", "type": "uint256" }], "internalType": "struct rl._skills", "name": "skills", "type": "tuple" }, { "components": [{ "internalType": "uint256", "name": "balance", "type": "uint256" }, { "internalType": "uint256", "name": "claimed", "type": "uint256" }, { "internalType": "uint256", "name": "claimable", "type": "uint256" }], "internalType": "struct rl._gold", "name": "gold", "type": "tuple" }, { "components": [{ "internalType": "uint256", "name": "balance", "type": "uint256" }, { "internalType": "uint256", "name": "scout", "type": "uint256" }], "internalType": "struct rl._material[]", "name": "materials", "type": "tuple[]" }], "internalType": "struct rl._summoner", "name": "s", "type": "tuple" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256[]", "name": "_s", "type": "uint256[]" }], "name": "summoners_full", "outputs": [{ "components": [{ "components": [{ "internalType": "string", "name": "name", "type": "string" }, { "internalType": "uint256", "name": "xp", "type": "uint256" }, { "internalType": "uint256", "name": "log", "type": "uint256" }, { "internalType": "uint256", "name": "class", "type": "uint256" }, { "internalType": "uint256", "name": "level", "type": "uint256" }], "internalType": "struct rl._base", "name": "base", "type": "tuple" }, { "components": [{ "components": [{ "internalType": "uint32", "name": "_str", "type": "uint32" }, { "internalType": "uint32", "name": "_dex", "type": "uint32" }, { "internalType": "uint32", "name": "_con", "type": "uint32" }, { "internalType": "uint32", "name": "_int", "type": "uint32" }, { "internalType": "uint32", "name": "_wis", "type": "uint32" }, { "internalType": "uint32", "name": "_cha", "type": "uint32" }], "internalType": "struct rl._ability_scores", "name": "attributes", "type": "tuple" }, { "components": [{ "internalType": "int32", "name": "_str", "type": "int32" }, { "internalType": "int32", "name": "_dex", "type": "int32" }, { "internalType": "int32", "name": "_con", "type": "int32" }, { "internalType": "int32", "name": "_int", "type": "int32" }, { "internalType": "int32", "name": "_wis", "type": "int32" }, { "internalType": "int32", "name": "_cha", "type": "int32" }], "internalType": "struct rl._ability_modifiers", "name": "modifiers", "type": "tuple" }, { "internalType": "uint256", "name": "total_points", "type": "uint256" }, { "internalType": "uint256", "name": "spent_points", "type": "uint256" }, { "internalType": "bool", "name": "created", "type": "bool" }], "internalType": "struct rl._ability_scores_full", "name": "ability_scores", "type": "tuple" }, { "components": [{ "internalType": "uint8[36]", "name": "skills", "type": "uint8[36]" }, { "internalType": "bool[36]", "name": "class_skills", "type": "bool[36]" }, { "internalType": "uint256", "name": "total_points", "type": "uint256" }, { "internalType": "uint256", "name": "spent_points", "type": "uint256" }], "internalType": "struct rl._skills", "name": "skills", "type": "tuple" }, { "components": [{ "internalType": "uint256", "name": "balance", "type": "uint256" }, { "internalType": "uint256", "name": "claimed", "type": "uint256" }, { "internalType": "uint256", "name": "claimable", "type": "uint256" }], "internalType": "struct rl._gold", "name": "gold", "type": "tuple" }, { "components": [{ "internalType": "uint256", "name": "balance", "type": "uint256" }, { "internalType": "uint256", "name": "scout", "type": "uint256" }], "internalType": "struct rl._material[]", "name": "materials", "type": "tuple[]" }], "internalType": "struct rl._summoner[]", "name": "s", "type": "tuple[]" }], "stateMutability": "view", "type": "function" }, { "inputs": [{ "internalType": "uint256", "name": "level", "type": "uint256" }], "name": "wealth_by_level", "outputs": [{ "internalType": "uint256", "name": "wealth", "type": "uint256" }], "stateMutability": "pure", "type": "function" }];


const iface_abiRarity = new ethers.utils.Interface(abiRarity);
const iface_abiRarityAttr = new ethers.utils.Interface(abiRarityAttr);
const iface_abiRarityGold = new ethers.utils.Interface(abiRarityGold);
const iface_abiRarityAbilities = new ethers.utils.Interface(abiRarityAbilities);
const iface_abiRarityLibrary = new ethers.utils.Interface(abiRarityLibrary);



//Allow all requests from all domains & localhost
app.all('/*', function(req, res, next) {
  res.header("Access-Control-Allow-Origin", "*");
  res.header("Access-Control-Allow-Headers", "X-Requested-With, Content-Type, Accept");
  res.header("Access-Control-Allow-Methods", "POST, GET");
  next();
});

app.use(bodyParser.json());
app.use(bodyParser.urlencoded({extended: false}));


 

app.get('/api', (req, res) => {

    var ids = req.query.ids

    var testme = "1";
    web3.eth.call({
      to: "0xa1364d81d86e88cfD018CCa4ac239A997dc96F31",
      data: iface_abiRarityLibrary.encodeFunctionData("summoner_full", [1290673])
  }, "latest", function (err, result) {
//      console.log(result)
      var xxxxxxx = iface_abiRarityLibrary.decodeFunctionResult("summoner_full", result);
      console.log(xxxxxxx.toString())

      var allFields = (xxxxxxx.toString()).split(",")

      res.send({allFields});
  })

});


app.listen(6069);
